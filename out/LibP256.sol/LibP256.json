{"abi":[{"type":"error","name":"InvalidP256Signature","inputs":[]}],"bytecode":{"object":"0x6080806040523460175760399081601c823930815050f35b5f80fdfe5f80fdfea2646970667358221220ab7da53eb91217caf7284973141ec7865394f4b5b8c8b7881dc1d3fae002d60564736f6c63430008210033","sourceMap":"302:1160:4:-:0;;;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x5f80fdfea2646970667358221220ab7da53eb91217caf7284973141ec7865394f4b5b8c8b7881dc1d3fae002d60564736f6c63430008210033","sourceMap":"302:1160:4:-:0;;","linkReferences":{}},"methodIdentifiers":{},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.33+commit.64118f21\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"name\":\"InvalidP256Signature\",\"type\":\"error\"}],\"devdoc\":{\"details\":\"Enables verification of WebAuthn/Passkeys and HSM signatures.      Target Address: 0x100 (Common for RIP-7212 implementations like Gnosis/Base/Arbitrum)\",\"kind\":\"dev\",\"methods\":{},\"title\":\"LibP256\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"Wrapper for EIP-7212 (secp256r1) Precompile\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/LibP256.sol\":\"LibP256\"},\"evmVersion\":\"osaka\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/solady/test/utils/forge-std/\",\":solady-clz/=lib/solady/src/utils/clz/\",\":solady-utils/=lib/solady/src/utils/\",\":solady/=lib/solady/\"],\"viaIR\":true},\"sources\":{\"contracts/LibP256.sol\":{\"keccak256\":\"0xe34c9e9c77f21f6e4190a9269de21ca13880c77d73f4b3b72395fc0b369149c6\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://50bd76d2e6d9997028911de15d64c56d98e4fb789aeeb90f172da74a5b0aaf98\",\"dweb:/ipfs/Qmb69D83ogk77dqpZCWwmD9bMqvrq9iM7jrHdiFRwa2KRT\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.33+commit.64118f21"},"language":"Solidity","output":{"abi":[{"inputs":[],"type":"error","name":"InvalidP256Signature"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["forge-std/=lib/solady/test/utils/forge-std/","solady-clz/=lib/solady/src/utils/clz/","solady-utils/=lib/solady/src/utils/","solady/=lib/solady/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"contracts/LibP256.sol":"LibP256"},"evmVersion":"osaka","libraries":{},"viaIR":true},"sources":{"contracts/LibP256.sol":{"keccak256":"0xe34c9e9c77f21f6e4190a9269de21ca13880c77d73f4b3b72395fc0b369149c6","urls":["bzz-raw://50bd76d2e6d9997028911de15d64c56d98e4fb789aeeb90f172da74a5b0aaf98","dweb:/ipfs/Qmb69D83ogk77dqpZCWwmD9bMqvrq9iM7jrHdiFRwa2KRT"],"license":"MIT"}},"version":1},"ast":{"absolutePath":"contracts/LibP256.sol","id":5562,"exportedSymbols":{"LibP256":[5561]},"nodeType":"SourceUnit","src":"32:1431:4","nodes":[{"id":5494,"nodeType":"PragmaDirective","src":"32:23:4","nodes":[],"literals":["solidity","0.8",".33"]},{"id":5561,"nodeType":"ContractDefinition","src":"302:1160:4","nodes":[{"id":5501,"nodeType":"VariableDeclaration","src":"384:45:4","nodes":[],"constant":true,"mutability":"constant","name":"P256_VERIFY","nameLocation":"401:11:4","scope":5561,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":5496,"name":"address","nodeType":"ElementaryTypeName","src":"384:7:4","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"value":{"arguments":[{"hexValue":"3078313030","id":5499,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"423:5:4","typeDescriptions":{"typeIdentifier":"t_rational_256_by_1","typeString":"int_const 256"},"value":"0x100"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_rational_256_by_1","typeString":"int_const 256"}],"id":5498,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"415:7:4","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":5497,"name":"address","nodeType":"ElementaryTypeName","src":"415:7:4","typeDescriptions":{}}},"id":5500,"isConstant":false,"isLValue":false,"isPure":true,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"415:14:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"},{"id":5503,"nodeType":"ErrorDefinition","src":"436:29:4","nodes":[],"errorSelector":"16a1bdef","name":"InvalidP256Signature","nameLocation":"442:20:4","parameters":{"id":5502,"nodeType":"ParameterList","parameters":[],"src":"462:2:4"}},{"id":5560,"nodeType":"FunctionDefinition","src":"879:580:4","nodes":[],"body":{"id":5559,"nodeType":"Block","src":"991:468:4","nodes":[],"statements":[{"assignments":[5520],"declarations":[{"constant":false,"id":5520,"mutability":"mutable","name":"input","nameLocation":"1085:5:4","nodeType":"VariableDeclaration","scope":5559,"src":"1072:18:4","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes"},"typeName":{"id":5519,"name":"bytes","nodeType":"ElementaryTypeName","src":"1072:5:4","typeDescriptions":{"typeIdentifier":"t_bytes_storage_ptr","typeString":"bytes"}},"visibility":"internal"}],"id":5529,"initialValue":{"arguments":[{"id":5523,"name":"hash","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5506,"src":"1110:4:4","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},{"id":5524,"name":"r","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5508,"src":"1116:1:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":5525,"name":"s","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5510,"src":"1119:1:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":5526,"name":"x","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5512,"src":"1122:1:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":5527,"name":"y","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5514,"src":"1125:1:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"},{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint256","typeString":"uint256"}],"expression":{"id":5521,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"1093:3:4","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":5522,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberLocation":"1097:12:4","memberName":"encodePacked","nodeType":"MemberAccess","src":"1093:16:4","typeDescriptions":{"typeIdentifier":"t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$","typeString":"function () pure returns (bytes memory)"}},"id":5528,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1093:34:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}},"nodeType":"VariableDeclarationStatement","src":"1072:55:4"},{"assignments":[5531,5533],"declarations":[{"constant":false,"id":5531,"mutability":"mutable","name":"success","nameLocation":"1171:7:4","nodeType":"VariableDeclaration","scope":5559,"src":"1166:12:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":5530,"name":"bool","nodeType":"ElementaryTypeName","src":"1166:4:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"},{"constant":false,"id":5533,"mutability":"mutable","name":"ret","nameLocation":"1193:3:4","nodeType":"VariableDeclaration","scope":5559,"src":"1180:16:4","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes"},"typeName":{"id":5532,"name":"bytes","nodeType":"ElementaryTypeName","src":"1180:5:4","typeDescriptions":{"typeIdentifier":"t_bytes_storage_ptr","typeString":"bytes"}},"visibility":"internal"}],"id":5538,"initialValue":{"arguments":[{"id":5536,"name":"input","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5520,"src":"1223:5:4","typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"expression":{"id":5534,"name":"P256_VERIFY","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5501,"src":"1200:11:4","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"id":5535,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1212:10:4","memberName":"staticcall","nodeType":"MemberAccess","src":"1200:22:4","typeDescriptions":{"typeIdentifier":"t_function_barestaticcall_view$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$","typeString":"function (bytes memory) view returns (bool,bytes memory)"}},"id":5537,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1200:29:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$_t_bool_$_t_bytes_memory_ptr_$","typeString":"tuple(bool,bytes memory)"}},"nodeType":"VariableDeclarationStatement","src":"1165:64:4"},{"condition":{"commonType":{"typeIdentifier":"t_bool","typeString":"bool"},"id":5545,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":5540,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"UnaryOperation","operator":"!","prefix":true,"src":"1362:8:4","subExpression":{"id":5539,"name":"success","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5531,"src":"1363:7:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"nodeType":"BinaryOperation","operator":"||","rightExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":5544,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"id":5541,"name":"ret","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5533,"src":"1374:3:4","typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}},"id":5542,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"1378:6:4","memberName":"length","nodeType":"MemberAccess","src":"1374:10:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"==","rightExpression":{"hexValue":"30","id":5543,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"1388:1:4","typeDescriptions":{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"},"value":"0"},"src":"1374:15:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"src":"1362:27:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":5548,"nodeType":"IfStatement","src":"1358:45:4","trueBody":{"expression":{"hexValue":"66616c7365","id":5546,"isConstant":false,"isLValue":false,"isPure":true,"kind":"bool","lValueRequested":false,"nodeType":"Literal","src":"1398:5:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"value":"false"},"functionReturnParameters":5518,"id":5547,"nodeType":"Return","src":"1391:12:4"}},{"expression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":5557,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"arguments":[{"id":5551,"name":"ret","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5533,"src":"1432:3:4","typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}},{"components":[{"id":5553,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"1438:7:4","typeDescriptions":{"typeIdentifier":"t_type$_t_uint256_$","typeString":"type(uint256)"},"typeName":{"id":5552,"name":"uint256","nodeType":"ElementaryTypeName","src":"1438:7:4","typeDescriptions":{}}}],"id":5554,"isConstant":false,"isInlineArray":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"TupleExpression","src":"1437:9:4","typeDescriptions":{"typeIdentifier":"t_type$_t_uint256_$","typeString":"type(uint256)"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"},{"typeIdentifier":"t_type$_t_uint256_$","typeString":"type(uint256)"}],"expression":{"id":5549,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"1421:3:4","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":5550,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberLocation":"1425:6:4","memberName":"decode","nodeType":"MemberAccess","src":"1421:10:4","typeDescriptions":{"typeIdentifier":"t_function_abidecode_pure$__$returns$__$","typeString":"function () pure"}},"id":5555,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"1421:26:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"==","rightExpression":{"hexValue":"31","id":5556,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"1451:1:4","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"src":"1421:31:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"functionReturnParameters":5518,"id":5558,"nodeType":"Return","src":"1414:38:4"}]},"documentation":{"id":5504,"nodeType":"StructuredDocumentation","src":"471:403:4","text":" @notice Verify a secp256r1 (P-256) signature\n @param hash The 32-byte message hash\n @param r The r component of the signature (32 bytes)\n @param s The s component of the signature (32 bytes)\n @param x The x coordinate of the public key (32 bytes)\n @param y The y coordinate of the public key (32 bytes)\n @return valid True if the signature is valid"},"implemented":true,"kind":"function","modifiers":[],"name":"verifySignature","nameLocation":"888:15:4","parameters":{"id":5515,"nodeType":"ParameterList","parameters":[{"constant":false,"id":5506,"mutability":"mutable","name":"hash","nameLocation":"912:4:4","nodeType":"VariableDeclaration","scope":5560,"src":"904:12:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"},"typeName":{"id":5505,"name":"bytes32","nodeType":"ElementaryTypeName","src":"904:7:4","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"visibility":"internal"},{"constant":false,"id":5508,"mutability":"mutable","name":"r","nameLocation":"926:1:4","nodeType":"VariableDeclaration","scope":5560,"src":"918:9:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":5507,"name":"uint256","nodeType":"ElementaryTypeName","src":"918:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":5510,"mutability":"mutable","name":"s","nameLocation":"937:1:4","nodeType":"VariableDeclaration","scope":5560,"src":"929:9:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":5509,"name":"uint256","nodeType":"ElementaryTypeName","src":"929:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":5512,"mutability":"mutable","name":"x","nameLocation":"948:1:4","nodeType":"VariableDeclaration","scope":5560,"src":"940:9:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":5511,"name":"uint256","nodeType":"ElementaryTypeName","src":"940:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":5514,"mutability":"mutable","name":"y","nameLocation":"959:1:4","nodeType":"VariableDeclaration","scope":5560,"src":"951:9:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":5513,"name":"uint256","nodeType":"ElementaryTypeName","src":"951:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"903:58:4"},"returnParameters":{"id":5518,"nodeType":"ParameterList","parameters":[{"constant":false,"id":5517,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":5560,"src":"985:4:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":5516,"name":"bool","nodeType":"ElementaryTypeName","src":"985:4:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"}],"src":"984:6:4"},"scope":5561,"stateMutability":"view","virtual":false,"visibility":"internal"}],"abstract":false,"baseContracts":[],"canonicalName":"LibP256","contractDependencies":[],"contractKind":"library","documentation":{"id":5495,"nodeType":"StructuredDocumentation","src":"57:244:4","text":" @title LibP256\n @notice Wrapper for EIP-7212 (secp256r1) Precompile\n @dev Enables verification of WebAuthn/Passkeys and HSM signatures.\n      Target Address: 0x100 (Common for RIP-7212 implementations like Gnosis/Base/Arbitrum)"},"fullyImplemented":true,"linearizedBaseContracts":[5561],"name":"LibP256","nameLocation":"310:7:4","scope":5562,"usedErrors":[5503],"usedEvents":[]}],"license":"MIT"},"id":4}